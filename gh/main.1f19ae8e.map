{"version":3,"sources":["Animations.js","MV+.js","Extent.js","filereaders.js","Mesh.js","webgl-setup.js","KeyboardUI.js","main.js"],"names":["AnimationState","settings","id","initialize","explosion","AnimationTracker","explosion_speed","xrotation","rotation_speed","xtranslation","x_speed","ytranslation","y_speed","ztranslation","z_speed","animations","translations","callback","window","requestAnimationFrame","cancelAnimationFrame","forEach","a","stop","speed","scale","lastupdated","_position","performance","now","timeSinceUpdate","updatePosition","start","argumentsToArray","args","concat","apply","Array","prototype","slice","radians","degrees","Math","PI","vec2","arguments","length","push","vec3","vec4","x","y","z","w","mat2","v","m","splice","matrix","mat3","mat4","equal","u","i","j","add","result","subtract","mult","reduce","_mult","sum","k","translate","isArray","rotate","angle","axis","normalize","c","cos","omc","s","sin","rotateX","theta","rotateY","rotateZ","scalem","lookAt","eye","at","up","n","cross","negate","dot","ortho","left","right","bottom","top","near","far","h","d","perspectiveDeg","fovy","aspect","perspectiveRad","f","tan","transpose","sqrt","excludeLastComponent","last","pop","len","isFinite","mix","flatten","elemsAreArrays","floats","Float32Array","idx","sizeof","byteLength","printm","console","log","det2","det3","det4","m0","m1","m2","m3","det","inverse2","inverse3","a00","a01","a02","a10","a11","a12","a20","a21","a22","inverse4","a03","a13","a23","a30","a31","a32","a33","inverse","normalMatrix","flag","b","Extent","abs","height","width","depth","vecs","size","extent","ext","vec","min","max","readFile","event","Promise","resolve","reader","FileReader","onload","e","target","value","readAsText","files","parsePly","text","match","parseError","lines","toLowerCase","split","filter","line","startsWith","map","trim","numvertices","parseInt","numfaces","isNaN","vertices","parseFloat","faces","some","vertex","face","msg","Mesh","fromVecs","_allvertices","Object","freeze","flatMap","faceoffsets","offset","_faces","_normals","face2","vertexpairs","_","x1","y1","z1","x2","y2","z2","showError","message","errelt","document","querySelector","innerHTML","style","display","makeShader","gl","shaderType","programText","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","error","getShaderInfoLog","shaderCreationError","VERTEX_SHADER","linkShaders","vertexShader","fragmentShader","program","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getProgramInfoLog","shaderLinkError","setupWebGL","canvas","getContext","webGlSetupError","enableVAO","vao","getExtension","VAOError","setupProgram","vertexShaderProgram","fragmentShaderProgram","FRAGMENT_SHADER","uiKey","key","activate","offKey","classList","deactivate","toggle","disableShared","active","contains","deactivateSelector","remove","deactivateAll","deactivateClass","classname","selector","querySelectorAll","EXPLOSION_SCALE","EXPLOSION_SPEED","ROTATION_SPEED","X_SPEED","Y_SPEED","Z_SPEED","MULTI_AXIS_MOVEMENT","X_FIELD_OF_VIEW","ASPECT_RATIO","MIN_CANVAS_HEIGHT","PERSPECTIVE_NEAR_PLANE","PERSPECTIVE_FAR_PLANE","body","getComputedStyle","scrollHeight","marginTop","innerHeight","clientWidth","Error","useProgram","buffers","position","createBuffer","normal","getAttribLocation","faceNormal","explosionScale","getUniformLocation","modelMatrix","viewMatrix","projectionMatrix","Settings","uiElements","seal","explosion_scale","multi_axis_movement","setting","element","easeExplosion","t","animationState","clearCanvas","clearColor","clearDepth","clear","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","distance","p1","p2","setProjection","mesh","bounds","fov_x","fov_y","width_distance","height_distance","camera_z","MV","midpoint","margins","uniformMatrix4fv","setNormals","bindBuffer","ARRAY_BUFFER","vertexAttribPointer","FLOAT","enableVertexAttribArray","bufferData","normals","STATIC_DRAW","setVertices","animateMesh","reset","drawMesh","explosionSize","radius","t_exp","normalScale","uniform1f","rotation","tr_x","tr_y","tr_z","translation","model","drawArrays","LINE_LOOP","animate","addEventListener","innerText","then","catch","reason","cancel","toUpperCase","Key","translationControl","opposingKey","animation","undefined","alreadyRunning","isrunning","stopTranslations","preventDefault","toggleControl","hasOwnProperty","ctrlKey","altKey","metaKey","stopAnimations","bindUI","bindSlider","object","property","defaultvalue","slider"],"mappings":"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","file":"main.1f19ae8e.map","sourceRoot":"../src","sourcesContent":["/**\n * Class tracking state of each animation (translation, rotation, and explosion)\n *\n * The current animation state is stored in the variable {@code animationState},\n * which should be the only instance of this class. Do not attempt to save\n * references to its value, as it will change when the state is reset.\n *\n * Explosion and rotation are represented as pausable timers that increase while\n * the animations are running.\n *\n * The translations are represented as bi-directional timers that increase for\n * positive motion and decrease for negative motion.\n *\n * The animations' effects are determined by functions of the timers' values in\n * {@link drawMesh}.\n *\n * @property {PausableTimer} explosion time spent in explosion/pulse animation\n *\n * @property {AnimationTracer} xrotation State of rotation around X-axis\n *\n * @property {ReversableTimer} xtranslation difference between time spent moving\n *                                          in positive and negative X direction\n * @property {ReversableTimer} ytranslation difference between time spent moving\n *                                          in positive and negative Y direction\n * @property {ReversableTimer} ztranslation difference between time spent moving\n *                                          in positive and negative Z direction\n */\nexport class AnimationState {\n    /**\n     * Create a new animation state obejct using the given settings object.\n     *\n     * @param {Object} settings The animations' settings.\n     *\n     * The settings object may be modified to change the animation's settings.\n     *\n     * To replace the animation state, use the {@code reset} method.\n     */\n    constructor(settings) {\n        this.id = null; // The ID of the current animation frame\n        this.settings = settings;\n        this.initialize(settings);\n    }\n\n    initialize(settings) {\n        this.explosion = new AnimationTracker(() => settings.explosion_speed);\n        this.xrotation = new AnimationTracker(() => settings.rotation_speed);\n\n        this.xtranslation = new AnimationTracker(() => settings.x_speed);\n        this.ytranslation = new AnimationTracker(() => settings.y_speed);\n        this.ztranslation = new AnimationTracker(() => settings.z_speed);\n\n        this.animations = [this.explosion,\n                           this.xrotation,\n                           this.xtranslation,\n                           this.ytranslation,\n                           this.ztranslation];\n\n        this.translations = [this.xtranslation,\n                             this.ytranslation,\n                             this.ztranslation];\n    }\n\n    /** * Reset the global animation state */\n    reset() {\n        this.initialize(this.settings);\n    }\n\n    /** * Request an animation frame and save its ID */\n    animate(callback) {\n        this.id = window.requestAnimationFrame(callback);\n    }\n\n    cancel() {\n        if (this.id !== null) {\n            window.cancelAnimationFrame(this.id);\n        }\n    }\n\n    stopAnimations() {\n        this.animations.forEach(a => a.stop());\n    }\n\n    stopTranslations() {\n        this.translations.forEach(a => a.stop());\n    }\n}\n\n/**\n * Timer for animations; tracks position in an animation\n *\n * @property {number} speed A function that will return the animation's speed in\n *                          units per millisecond\n * @property {?number} lastupdated The time the animation was last updated, or\n *                                 null if the animation is not running\n * @property {number} scale A multiplier for the speed, useful for reversing (-1)\n *\n * Whenever the animation is checked, if it is running, the time since the last\n * check is multiplied by its speed and scale, and the result is added to the\n * position.\n *\n * Every millisecond that the animation runs, it moves an amount equal to the\n * product of its speed and scale.\n */\nexport class AnimationTracker {\n    constructor(speed = () => 1) {\n        this.speed = speed;\n        this.scale = 1;\n        this.lastupdated = null;\n        this._position = 0;\n    }\n\n    /** @returns time since position was last updated */\n    timeSinceUpdate() {\n        return window.performance.now() - this.lastupdated;\n    }\n\n    /** Update the animation's position by its speed */\n    updatePosition() {\n        if (this.lastupdated) {\n            this._position += this.scale * this.speed() * this.timeSinceUpdate();\n            this.lastupdated = window.performance.now();\n        }\n    }\n\n    // Main public API\n\n    isrunning() {\n        return this.lastupdated !== null;\n    }\n\n    /**\n     * Get the current position in the animation\n     */\n    get position() {\n        this.updatePosition();\n        return this._position;\n    }\n\n    start() {\n        if (!this.lastupdated) {\n            this.lastupdated = window.performance.now();\n        }\n    }\n\n    stop() {\n        this.updatePosition();\n        this.lastupdated = null;\n    }\n\n    /**\n     * Toggle the animation and return whether it is running\n     */\n    toggle() {\n        if (this.lastupdated) {\n            this.stop();\n        }\n        else {\n            this.start();\n        }\n        return this.lastupdated !== null;\n    }\n}\n","//////////////////////////////////////////////////////////////////////////////\n//\n//  Angel.js\n//\n//////////////////////////////////////////////////////////////////////////////\n//\n//  Modified for use as an ES6 module.\n//  Style improved.\n//  Some ES6 features added.\n//\n//////////////////////////////////////////////////////////////////////////////\n\nfunction argumentsToArray(args)\n{\n    return [].concat.apply([], Array.prototype.slice.apply(args));\n}\n\n//----------------------------------------------------------------------------\n//\n//  Helper functions\n//\n\n//----------------------------------------------------------------------------\n\nexport function radians(degrees) {\n    return degrees * Math.PI / 180.0;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Vector Constructors\n//\n\nexport function vec2() {\n    // argumensToArray allows inputs to be any combination of individual\n    // elements and arrays.\n\n    let args = argumentsToArray(arguments);\n\n    switch (args.length) {\n    // Intentional fallthrough\n    case 0: args.push(0); // x\n    case 1: args.push(0); // y\n    }\n    return args.slice(0, 2);\n}\n\nexport function vec3() {\n    let args = argumentsToArray(arguments);\n\n    switch (args.length) {\n    // Intentional fallthrough\n    case 0: args.push(0); // x\n    case 1: args.push(0); // y\n    case 2: args.push(0); // z\n    }\n    return args.slice(0, 3);\n}\n\nexport function vec4(x = 0, y = 0, z = 0, w = 1) {\n    let args = argumentsToArray(arguments);\n\n    switch (args.length) {\n    // Intentional fallthrough\n    case 0: args.push(0); // x\n    case 1: args.push(0); // y\n    case 2: args.push(0); // z\n    case 3: args.push(1); // w\n    }\n    return args.slice(0, 4);\n}\n\n//----------------------------------------------------------------------------\n//\n//  Matrix Constructors\n//\n\nexport function mat2()\n{\n    let v = argumentsToArray(arguments);\n\n    let m = [];\n    switch ( v.length ) {\n    case 0:\n        v[0] = 1;\n    case 1:\n        m = [\n            vec2( v[0],  0.0 ),\n            vec2(  0.0, v[0] )\n        ];\n        break;\n\n    default:\n        m.push( vec2(v) );  v.splice( 0, 2 );\n        m.push( vec2(v) );\n        break;\n    }\n\n    m.matrix = true;\n\n    return m;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mat3()\n{\n    let v = argumentsToArray(arguments);\n\n    let m = [];\n    switch ( v.length ) {\n    case 0:\n        v[0] = 1;\n    case 1:\n        m = [\n            vec3( v[0],  0.0,  0.0 ),\n            vec3(  0.0, v[0],  0.0 ),\n            vec3(  0.0,  0.0, v[0] )\n        ];\n        break;\n\n    default:\n        m.push( vec3(v) );  v.splice( 0, 3 );\n        m.push( vec3(v) );  v.splice( 0, 3 );\n        m.push( vec3(v) );\n        break;\n    }\n\n    m.matrix = true;\n\n    return m;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mat4()\n{\n    let v = argumentsToArray(arguments);\n\n    let m = [];\n    switch ( v.length ) {\n    case 0:\n        v[0] = 1;\n    case 1:\n        m = [\n            vec4( v[0], 0.0,  0.0,   0.0 ),\n            vec4( 0.0,  v[0], 0.0,   0.0 ),\n            vec4( 0.0,  0.0,  v[0],  0.0 ),\n            vec4( 0.0,  0.0,  0.0,  v[0] )\n        ];\n        break;\n\n    default:\n        m.push( vec4(v) );  v.splice( 0, 4 );\n        m.push( vec4(v) );  v.splice( 0, 4 );\n        m.push( vec4(v) );  v.splice( 0, 4 );\n        m.push( vec4(v) );\n        break;\n    }\n\n    m.matrix = true;\n\n    return m;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Generic Mathematical Operations for Vectors and Matrices\n//\n\nexport function equal(u, v)\n{\n    if (u.length !== v.length) {\n        return false;\n    }\n\n    if (u.matrix && v.matrix) {\n        for (let i = 0; i < u.length; ++i) {\n            if (u[i].length !== v[i].length) {\n                return false;\n            }\n            for (let j = 0; j < u[i].length; ++j) {\n                if (u[i][j] !== v[i][j]) {\n                    return false;\n                }\n            }\n        }\n    }\n    else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n        return false;\n    }\n    else {\n        for (let i = 0; i < u.length; ++i) {\n            if (u[i] !== v[i]) {\n                return false;\n            }\n        }\n    }\n\n    return true;\n}\n\n//----------------------------------------------------------------------------\n\nexport function add(u, v)\n{\n    let result = [];\n\n    if (u.matrix && v.matrix) {\n        if (u.length !== v.length) {\n            throw \"add(): trying to add matrices of different dimensions\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            if (u[i].length !== v[i].length) {\n                throw \"add(): trying to add matrices of different dimensions\";\n            }\n            result.push( [] );\n            for (let j = 0; j < u[i].length; ++j) {\n                result[i].push( u[i][j] + v[i][j] );\n            }\n        }\n\n        result.matrix = true;\n\n        return result;\n    }\n    else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n        throw \"add(): trying to add matrix and non-matrix variables\";\n    }\n    else {\n        if (u.length !== v.length) {\n            throw \"add(): vectors are not the same dimension\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            result.push( u[i] + v[i] );\n        }\n\n        return result;\n    }\n}\n\n//----------------------------------------------------------------------------\n\nexport function subtract(u, v)\n{\n    let result = [];\n\n    if (u.matrix && v.matrix) {\n        if (u.length !== v.length) {\n            throw \"subtract(): trying to subtract matrices\" +\n            \" of different dimensions\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            if (u[i].length !== v[i].length) {\n                throw \"subtract(): trying to subtact matrices\" +\n                \" of different dimensions\";\n            }\n            result.push( [] );\n            for (let j = 0; j < u[i].length; ++j) {\n                result[i].push( u[i][j] - v[i][j] );\n            }\n        }\n\n        result.matrix = true;\n\n        return result;\n    }\n    else if (u.matrix && !v.matrix || !u.matrix && v.matrix) {\n        throw \"subtact(): trying to subtact  matrix and non-matrix variables\";\n    }\n    else {\n        if (u.length !== v.length) {\n            throw \"subtract(): vectors are not the same length\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            result.push( u[i] - v[i] );\n        }\n\n        return result;\n    }\n}\n\n//----------------------------------------------------------------------------\n\nexport function mult(...m) {\n    if (m.length === 0) {\n        throw \"mult(): trying to multiply no matrices\";\n    }\n    return m.reduce(_mult);\n}\n\nfunction _mult(u, v)\n{\n    let result = [];\n\n    if (u.matrix && v.matrix) {\n        if (u.length !== v.length) {\n            throw \"mult(): trying to add matrices of different dimensions\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            if (u[i].length !== v[i].length) {\n                throw \"mult(): trying to add matrices of different dimensions\";\n            }\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            result.push( [] );\n\n            for (let j = 0; j < v.length; ++j) {\n                let sum = 0.0;\n                for (let k = 0; k < u.length; ++k ) {\n                    sum += u[i][k] * v[k][j];\n                }\n                result[i].push( sum );\n            }\n        }\n\n        result.matrix = true;\n\n        return result;\n    }\n\n    if (u.matrix && (u.length === v.length)) {\n        for (let i = 0; i<v.length; i++) {\n            let sum = 0.0;\n            for (let j=0; j<v.length; j++) {\n                sum += u[i][j]*v[j];\n            }\n            result.push(sum);\n        }\n        return result;\n    }\n\n\n\n    else {\n        if (u.length !== v.length) {\n            throw \"mult(): vectors are not the same dimension\";\n        }\n\n        for (let i = 0; i < u.length; ++i) {\n            result.push( u[i] * v[i] );\n        }\n\n        return result;\n    }\n}\n\n//----------------------------------------------------------------------------\n//\n//  Basic Transformation Matrix Generators\n//\n\nexport function translate(x, y, z)\n{\n    if (Array.isArray(x) && x.length === 3) {\n        z = x[2];\n        y = x[1];\n        x = x[0];\n    }\n\n    let result = mat4();\n    result[0][3] = x;\n    result[1][3] = y;\n    result[2][3] = z;\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function rotate(angle, axis)\n{\n    if (!Array.isArray(axis)) {\n        axis = [ arguments[1], arguments[2], arguments[3] ];\n    }\n\n    let v = normalize( axis );\n\n    let x = v[0];\n    let y = v[1];\n    let z = v[2];\n\n    let c = Math.cos( radians(angle) );\n    let omc = 1.0 - c;\n    let s = Math.sin( radians(angle) );\n\n    return mat4(\n        vec4(x * x * omc + c, x * y * omc - z * s, x * z * omc + y * s, 0.0),\n        vec4(x * y * omc + z * s, y * y * omc + c, y * z * omc - x * s, 0.0),\n        vec4(x * z * omc - y * s, y * z * omc + x * s, z * z * omc + c, 0.0),\n        vec4()\n    );\n}\n\nexport function rotateX(theta) {\n    let c = Math.cos( radians(theta) );\n    let s = Math.sin( radians(theta) );\n    return mat4(1.0, 0.0, 0.0, 0.0,\n        0.0, c, -s, 0.0,\n        0.0, s, c, 0.0,\n        0.0, 0.0, 0.0, 1.0);\n}\nexport function rotateY(theta) {\n    let c = Math.cos( radians(theta) );\n    let s = Math.sin( radians(theta) );\n    return mat4(c, 0.0, s, 0.0,\n        0.0, 1.0, 0.0, 0.0,\n        -s, 0.0, c, 0.0,\n        0.0, 0.0, 0.0, 1.0);\n}\nexport function rotateZ(theta) {\n    let c = Math.cos( radians(theta) );\n    let s = Math.sin( radians(theta) );\n    return mat4(c, -s, 0.0, 0.0,\n        s, c, 0.0, 0.0,\n        0.0, 0.0, 1.0, 0.0,\n        0.0, 0.0, 0.0, 1.0);\n}\n\n\n//----------------------------------------------------------------------------\n\nexport function scalem(x, y, z)\n{\n    if (Array.isArray(x) && x.length === 3) {\n        z = x[2];\n        y = x[1];\n        x = x[0];\n    }\n\n    let result = mat4();\n    result[0][0] = x;\n    result[1][1] = y;\n    result[2][2] = z;\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  ModelView Matrix Generators\n//\n\nexport function lookAt(eye, at, up)\n{\n    if (!Array.isArray(eye) || eye.length !== 3) {\n        throw \"lookAt(): first parameter [eye] must be an a vec3\";\n    }\n\n    if (!Array.isArray(at) || at.length !== 3) {\n        throw \"lookAt(): second parameter [at] must be an a vec3\";\n    }\n\n    if (!Array.isArray(up) || up.length !== 3) {\n        throw \"lookAt(): third parameter [up] must be an a vec3\";\n    }\n\n    if (equal(eye, at)) {\n        return mat4();\n    }\n\n    let v = normalize( subtract(at, eye) );  // view direction vector\n    let n = normalize( cross(v, up) );       // perpendicular vector\n    let u = normalize( cross(n, v) );        // \"new\" up vector\n\n    v = negate(v);\n\n    return mat4(\n        vec4(n, -dot(n, eye)),\n        vec4(u, -dot(u, eye)),\n        vec4(v, -dot(v, eye)),\n        vec4()\n    );\n}\n\n//----------------------------------------------------------------------------\n//\n//  Projection Matrix Generators\n//\n\nexport function ortho(left, right, bottom, top, near = 1, far = -1)\n{\n    if (left === right) { throw \"ortho(): left and right are equal\"; }\n    if (bottom === top) { throw \"ortho(): bottom and top are equal\"; }\n    if (near === far)   { throw \"ortho(): near and far are equal\"; }\n\n    let w = right - left;\n    let h = top - bottom;\n    let d = far - near;\n\n    let result = mat4();\n    result[0][0] = 2.0 / w;\n    result[1][1] = 2.0 / h;\n    result[2][2] = -2.0 / d;\n    result[0][3] = -(left + right) / w;\n    result[1][3] = -(top + bottom) / h;\n    result[2][3] = -(near + far) / d;\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function perspectiveDeg(fovy, aspect, near, far)\n{\n    return perspectiveRad(radians(fovy), aspect, near, far);\n}\n\nexport function perspectiveRad(fovy, aspect, near, far)\n{\n    let f = 1.0 / Math.tan( fovy / 2 );\n    let d = far - near;\n\n    let result = mat4();\n    result[0][0] = f / aspect;\n    result[1][1] = f;\n    result[2][2] = -(near + far) / d;\n    result[2][3] = -2 * near * far / d;\n    result[3][2] = -1;\n    result[3][3] = 0.0;\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Matrix Functions\n//\n\nexport function transpose(m)\n{\n    if (!m.matrix) {\n        return \"transpose(): trying to transpose a non-matrix\";\n    }\n\n    let result = [];\n    for (let i = 0; i < m.length; ++i) {\n        result.push( [] );\n        for (let j = 0; j < m[i].length; ++j) {\n            result[i].push( m[j][i] );\n        }\n    }\n\n    result.matrix = true;\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//  Vector Functions\n//\n\nexport function dot(u, v)\n{\n    if (u.length !== v.length) {\n        throw \"dot(): vectors are not the same dimension\";\n    }\n\n    let sum = 0.0;\n    for (let i = 0; i < u.length; ++i) {\n        sum += u[i] * v[i];\n    }\n\n    return sum;\n}\n\n//----------------------------------------------------------------------------\n\nexport function negate(u)\n{\n    let result = [];\n    for (let i = 0; i < u.length; ++i) {\n        result.push( -u[i] );\n    }\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n\nexport function cross(u, v)\n{\n    if (!Array.isArray(u) || u.length < 3) {\n        throw \"cross(): first argument is not a vector of at least 3\";\n    }\n\n    if (!Array.isArray(v) || v.length < 3) {\n        throw \"cross(): second argument is not a vector of at least 3\";\n    }\n\n    return [\n        u[1] * v[2] - u[2] * v[1],\n        u[2] * v[0] - u[0] * v[2],\n        u[0] * v[1] - u[1] * v[0]\n    ];\n}\n\n//----------------------------------------------------------------------------\n\nexport function length(u)\n{\n    return Math.sqrt( dot(u, u) );\n}\n\n//----------------------------------------------------------------------------\n\nexport function normalize(u, excludeLastComponent)\n{\n    if (excludeLastComponent) {\n        var last = u.pop();\n    }\n\n    let len = length(u);\n\n    if (!isFinite(len)) {\n        throw \"normalize: vector \" + u + \" has zero length\";\n    }\n\n    for (let i = 0; i < u.length; ++i) {\n        u[i] /= len;\n    }\n\n    if (excludeLastComponent) {\n        u.push( last );\n    }\n\n    return u;\n}\n\n//----------------------------------------------------------------------------\n\nexport function mix(u, v, s)\n{\n    if (typeof s !== \"number\") {\n        throw \"mix: the last paramter \" + s + \" must be a number\";\n    }\n\n    if (u.length !== v.length) {\n        throw \"vector dimension mismatch\";\n    }\n\n    let result = [];\n    for (let i = 0; i < u.length; ++i) {\n        result.push( (1.0 - s) * u[i] + s * v[i] );\n    }\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n//\n// Vector and Matrix functions\n//\n\nexport function scale(s, u)\n{\n    if (!Array.isArray(u)) {\n        throw \"scale: second parameter \" + u + \" is not a vector\";\n    }\n\n    let result = [];\n    for (let i = 0; i < u.length; ++i) {\n        result.push( s * u[i] );\n    }\n\n    return result;\n}\n\n//----------------------------------------------------------------------------\n//\n//\n//\n\nexport function flatten(v)\n{\n    if (v.matrix === true) {\n        v = transpose(v);\n    }\n\n    let n = v.length;\n    let elemsAreArrays = false;\n\n    if (Array.isArray(v[0])) {\n        elemsAreArrays = true;\n        n *= v[0].length;\n    }\n\n    let floats = new Float32Array(n);\n\n    if (elemsAreArrays) {\n        let idx = 0;\n        for (let i = 0; i < v.length; ++i) {\n            for (let j = 0; j < v[i].length; ++j) {\n                floats[idx++] = v[i][j];\n            }\n        }\n    }\n    else {\n        for (let i = 0; i < v.length; ++i) {\n            floats[i] = v[i];\n        }\n    }\n\n    return floats;\n}\n\n//----------------------------------------------------------------------------\n\nlet sizeof = {\n    'vec2' : new Float32Array( flatten(vec2()) ).byteLength,\n    'vec3' : new Float32Array( flatten(vec3()) ).byteLength,\n    'vec4' : new Float32Array( flatten(vec4()) ).byteLength,\n    'mat2' : new Float32Array( flatten(mat2()) ).byteLength,\n    'mat3' : new Float32Array( flatten(mat3()) ).byteLength,\n    'mat4' : new Float32Array( flatten(mat4()) ).byteLength\n};\n\n// new functions 5/2/2015\n\n// printing\n\nexport function printm(m)\n{\n    if (m.length === 2) {\n        for (let i = 0; i < m.length; i++) {\n            console.log(m[i][0], m[i][1]);\n        }\n    }\n    else if (m.length === 3) {\n        for (let i = 0; i < m.length; i++) {\n            console.log(m[i][0], m[i][1], m[i][2]);\n        }\n    }\n    else if (m.length === 4) {\n        for (let i = 0; i < m.length; i++) {\n            console.log(m[i][0], m[i][1], m[i][2], m[i][3]);\n        }\n    }\n}\n// determinants\n\nexport function det2(m)\n{\n\n    return m[0][0]*m[1][1]-m[0][1]*m[1][0];\n\n}\n\nexport function det3(m)\n{\n\n    return m[0][0] * m[1][1] * m[2][2]\n        + m[0][1] * m[1][2] * m[2][0]\n        + m[0][2] * m[2][1] * m[1][0]\n        - m[2][0] * m[1][1] * m[0][2]\n        - m[1][0] * m[0][1] * m[2][2]\n        - m[0][0] * m[1][2] * m[2][1];\n}\n\nexport function det4(m)\n{\n    let m0 = [\n        vec3(m[1][1], m[1][2], m[1][3]),\n        vec3(m[2][1], m[2][2], m[2][3]),\n        vec3(m[3][1], m[3][2], m[3][3])\n    ];\n    let m1 = [\n        vec3(m[1][0], m[1][2], m[1][3]),\n        vec3(m[2][0], m[2][2], m[2][3]),\n        vec3(m[3][0], m[3][2], m[3][3])\n    ];\n    let m2 = [\n        vec3(m[1][0], m[1][1], m[1][3]),\n        vec3(m[2][0], m[2][1], m[2][3]),\n        vec3(m[3][0], m[3][1], m[3][3])\n    ];\n    let m3 = [\n        vec3(m[1][0], m[1][1], m[1][2]),\n        vec3(m[2][0], m[2][1], m[2][2]),\n        vec3(m[3][0], m[3][1], m[3][2])\n    ];\n    return m[0][0]*det3(m0) - m[0][1]*det3(m1)\n        + m[0][2]*det3(m2) - m[0][3]*det3(m3);\n\n}\n\nexport function det(m)\n{\n    if (m.matrix !== true) console.log(\"not a matrix\");\n    if (m.length === 2) return det2(m);\n    if (m.length === 3) return det3(m);\n    if (m.length === 4) return det4(m);\n}\n\n//---------------------------------------------------------\n\n// inverses\n\nexport function inverse2(m)\n{\n    let a = mat2();\n    let d = det2(m);\n    a[0][0] = m[1][1]/d;\n    a[0][1] = -m[0][1]/d;\n    a[1][0] = -m[1][0]/d;\n    a[1][1] = m[0][0]/d;\n    a.matrix = true;\n    return a;\n}\n\nexport function inverse3(m)\n{\n    let a = mat3();\n    let d = det3(m);\n\n    let a00 = [\n        vec2(m[1][1], m[1][2]),\n        vec2(m[2][1], m[2][2])\n    ];\n    let a01 = [\n        vec2(m[1][0], m[1][2]),\n        vec2(m[2][0], m[2][2])\n    ];\n    let a02 = [\n        vec2(m[1][0], m[1][1]),\n        vec2(m[2][0], m[2][1])\n    ];\n    let a10 = [\n        vec2(m[0][1], m[0][2]),\n        vec2(m[2][1], m[2][2])\n    ];\n    let a11 = [\n        vec2(m[0][0], m[0][2]),\n        vec2(m[2][0], m[2][2])\n    ];\n    let a12 = [\n        vec2(m[0][0], m[0][1]),\n        vec2(m[2][0], m[2][1])\n    ];\n    let a20 = [\n        vec2(m[0][1], m[0][2]),\n        vec2(m[1][1], m[1][2])\n    ];\n    let a21 = [\n        vec2(m[0][0], m[0][2]),\n        vec2(m[1][0], m[1][2])\n    ];\n    let a22 = [\n        vec2(m[0][0], m[0][1]),\n        vec2(m[1][0], m[1][1])\n    ];\n\n    a[0][0] = det2(a00)/d;\n    a[0][1] = -det2(a10)/d;\n    a[0][2] = det2(a20)/d;\n    a[1][0] = -det2(a01)/d;\n    a[1][1] = det2(a11)/d;\n    a[1][2] = -det2(a21)/d;\n    a[2][0] = det2(a02)/d;\n    a[2][1] = -det2(a12)/d;\n    a[2][2] = det2(a22)/d;\n\n    return a;\n\n}\n\nexport function inverse4(m)\n{\n    let a = mat4();\n    let d = det4(m);\n\n    let a00 = [\n        vec3(m[1][1], m[1][2], m[1][3]),\n        vec3(m[2][1], m[2][2], m[2][3]),\n        vec3(m[3][1], m[3][2], m[3][3])\n    ];\n    let a01 = [\n        vec3(m[1][0], m[1][2], m[1][3]),\n        vec3(m[2][0], m[2][2], m[2][3]),\n        vec3(m[3][0], m[3][2], m[3][3])\n    ];\n    let a02 = [\n        vec3(m[1][0], m[1][1], m[1][3]),\n        vec3(m[2][0], m[2][1], m[2][3]),\n        vec3(m[3][0], m[3][1], m[3][3])\n    ];\n    let a03 = [\n        vec3(m[1][0], m[1][1], m[1][2]),\n        vec3(m[2][0], m[2][1], m[2][2]),\n        vec3(m[3][0], m[3][1], m[3][2])\n    ];\n    let a10 = [\n        vec3(m[0][1], m[0][2], m[0][3]),\n        vec3(m[2][1], m[2][2], m[2][3]),\n        vec3(m[3][1], m[3][2], m[3][3])\n    ];\n    let a11 = [\n        vec3(m[0][0], m[0][2], m[0][3]),\n        vec3(m[2][0], m[2][2], m[2][3]),\n        vec3(m[3][0], m[3][2], m[3][3])\n    ];\n    let a12 = [\n        vec3(m[0][0], m[0][1], m[0][3]),\n        vec3(m[2][0], m[2][1], m[2][3]),\n        vec3(m[3][0], m[3][1], m[3][3])\n    ];\n    let a13 = [\n        vec3(m[0][0], m[0][1], m[0][2]),\n        vec3(m[2][0], m[2][1], m[2][2]),\n        vec3(m[3][0], m[3][1], m[3][2])\n    ];\n    let a20 = [\n        vec3(m[0][1], m[0][2], m[0][3]),\n        vec3(m[1][1], m[1][2], m[1][3]),\n        vec3(m[3][1], m[3][2], m[3][3])\n    ];\n    let a21 = [\n        vec3(m[0][0], m[0][2], m[0][3]),\n        vec3(m[1][0], m[1][2], m[1][3]),\n        vec3(m[3][0], m[3][2], m[3][3])\n    ];\n    let a22 = [\n        vec3(m[0][0], m[0][1], m[0][3]),\n        vec3(m[1][0], m[1][1], m[1][3]),\n        vec3(m[3][0], m[3][1], m[3][3])\n    ];\n    let a23 = [\n        vec3(m[0][0], m[0][1], m[0][2]),\n        vec3(m[1][0], m[1][1], m[1][2]),\n        vec3(m[3][0], m[3][1], m[3][2])\n    ];\n\n    let a30 = [\n        vec3(m[0][1], m[0][2], m[0][3]),\n        vec3(m[1][1], m[1][2], m[1][3]),\n        vec3(m[2][1], m[2][2], m[2][3])\n    ];\n    let a31 = [\n        vec3(m[0][0], m[0][2], m[0][3]),\n        vec3(m[1][0], m[1][2], m[1][3]),\n        vec3(m[2][0], m[2][2], m[2][3])\n    ];\n    let a32 = [\n        vec3(m[0][0], m[0][1], m[0][3]),\n        vec3(m[1][0], m[1][1], m[1][3]),\n        vec3(m[2][0], m[2][1], m[2][3])\n    ];\n    let a33 = [\n        vec3(m[0][0], m[0][1], m[0][2]),\n        vec3(m[1][0], m[1][1], m[1][2]),\n        vec3(m[2][0], m[2][1], m[2][2])\n    ];\n\n\n\n    a[0][0] = det3(a00)/d;\n    a[0][1] = -det3(a10)/d;\n    a[0][2] = det3(a20)/d;\n    a[0][3] = -det3(a30)/d;\n    a[1][0] = -det3(a01)/d;\n    a[1][1] = det3(a11)/d;\n    a[1][2] = -det3(a21)/d;\n    a[1][3] = det3(a31)/d;\n    a[2][0] = det3(a02)/d;\n    a[2][1] = -det3(a12)/d;\n    a[2][2] = det3(a22)/d;\n    a[2][3] = -det3(a32)/d;\n    a[3][0] = -det3(a03)/d;\n    a[3][1] = det3(a13)/d;\n    a[3][2] = -det3(a23)/d;\n    a[3][3] = det3(a33)/d;\n\n    return a;\n}\nexport function inverse(m)\n{\n    if (m.matrix !== true) console.log(\"not a matrix\");\n    if (m.length === 2) return inverse2(m);\n    if (m.length === 3) return inverse3(m);\n    if (m.length === 4) return inverse4(m);\n}\n\nexport function normalMatrix(m, flag)\n{\n    let a = inverse(transpose(m));\n    if (flag !== true) return a;\n    else {\n        let b = mat3();\n        for (let i=0;i<3;i++) {\n            for (let j = 0; j < 3; j++) {\n                b[i][j] = a[i][j];\n            }\n        }\n        return b;\n    }\n\n}\n","\"use strict\";\n\nimport { vec3, ortho } from \"./MV+.js\";\n\n/**\n * Class representing the extent of a data file's contents.\n */\nexport class Extent {\n    constructor(left, right, bottom, top, near = 1, far = -1) {\n        this.left = left;\n        this.right = right;\n        this.top = top;\n        this.bottom = bottom;\n        this.near = near;\n        this.far = far;\n    }\n\n    /**\n     * Construct the extent of an array of vectors.\n     * @param {number[][]} vecs A non-empty array of vectors\n     * @return {Extent}\n     *\n     * The vectors should all have the same length of at least 2.\n     *\n     * If the list is empty, an error will occur.\n     */\n    static fromVecs(vecs) {\n        let size = vecs[0].length;\n\n        let extent = new Extent(vecs[0][0], vecs[0][0],\n                                vecs[0][1], vecs[0][1],\n                                vecs[0][2], vecs[0][2]);\n\n        return vecs.reduce(\n            (ext, vec) => {\n                ext.left = Math.min(ext.left, vec[0]);\n                ext.right = Math.max(ext.right, vec[0]);\n                ext.top = Math.max(ext.top, vec[1]);\n                ext.bottom = Math.min(ext.bottom, vec[1]);\n                if (size > 2) {\n                    ext.near = Math.max(ext.near, vec[2]);\n                    ext.far = Math.min(ext.far, vec[2]);\n                }\n                return ext;\n            }, extent);\n    }\n\n    /** Get the default extent */\n    static basic() {\n        return new Extent(-1, 1, -1, 1, 1, -1);\n    }\n\n    /** Convert to orthographic projection matrix */\n    asortho() {\n        return ortho(this.left, this.right, this.bottom, this.top, this.near, this.far);\n    }\n\n    get midpoint() {\n        return vec3((this.left + this.right) / 2,\n                    (this.top + this.bottom) / 2,\n                    (this.near + this.far) / 2);\n    }\n\n    get width() {\n        return Math.abs(this.right - this.left);\n    }\n\n    get height() {\n        return Math.abs(this.top - this.bottom);\n    }\n\n    get depth() {\n        return Math.abs(this.near - this.far);\n    }\n\n    get radius() {\n        return Math.sqrt((this.height / 2) ** 2 +\n                         (this.width / 2) ** 2 +\n                         (this.depth / 2) ** 2);\n    }\n}\n","\"use strict\";\n\nimport { vec3 } from \"./MV+.js\";\n\n/**\n * Read and draw a file.\n *\n * @param {Event} event The change event for a file input element.\n *\n * @returns {Promise} A promise containing the file's contents.\n */\nexport function readFile(event) {\n    return new Promise(resolve => {\n        let reader = new FileReader();\n        reader.onload = e => {\n            resolve(e.target.result);\n        };\n        if (event.target.value !== \"\") {\n            reader.readAsText(event.target.files[0]);\n        }\n    });\n}\n\n/**\n * Parse a limited subset of PLY files\n * @param {String} text  The text of a PLY file\n * @returns {[vec3[], number[][]]} The vertices and faces specified by the file.\n *\n * Only parses ASCII.\n *\n * Only parses files with three vertex properties (named x, y, and z; all\n * float32) and one face property (a list of polygon descriptions, a list of 1\n * uint8 and 3 int32s).\n *\n * Accepts comment lines (any line beginning with \"comment\").\n *\n * Ignores blank lines after the initial 'ply' line.\n */\nexport function parsePly(text) {\n\n    if (!text.match(/^ply(\\r|\\n|\\r\\n)/)) {\n        parseError(\"line 1: expected 'ply'\");\n    }\n\n    let lines = text.toLowerCase()\n        .split(/(\\r|\\n)+/) // split on any newline (gobbles empty lines)\n        .filter(line => !line.startsWith(\"comment\"))\n        .map(line => line.trim())\n        .filter(line => line !== \"\");\n\n    if (lines[1] !== \"format ascii 1.0\") {\n        parseError(\"line 2: expected 'format ascii 1.0'\");\n    }\n\n    if (!lines[2].startsWith(\"element vertex \") ||\n        lines[3] !== \"property float32 x\" ||\n        lines[4] !== \"property float32 y\" ||\n        lines[5] !== \"property float32 z\" ||\n        !lines[6].startsWith(\"element face\") ||\n        lines[7] !== \"property list uint8 int32 vertex_indices\" ||\n        lines[8] !== \"end_header\") {\n        parseError(\"in lines 3-9: wrong value\"); ; // line format\n    }\n\n    let numvertices = parseInt(lines[2].split(\" \")[2]);\n    let numfaces = parseInt(lines[6].split(\" \")[2]);\n\n    if (isNaN(numvertices) || isNaN(numfaces)) {\n        parseError(\"wrong number of vertices (line 3) or number of faces (line 7)\");\n    }\n\n    lines = lines.slice(9)\n        .map(line => line.split(/\\s+/));\n\n    let vertices = lines.slice(0, numvertices)\n        .map(line => line.map(parseFloat));\n\n    let faces = lines.slice(numvertices)\n        .map(line =>\n             line.map(n => parseInt(n)));\n\n    if (vertices.some(vertex => vertex.some(isNaN))\n        || faces.some(face => face.some(isNaN))) {\n        parseError(\"error in vertices or faces\");\n    }\n\n    if (vertices.length !== numvertices || faces.length !== numfaces) {\n        parseError(\"wrong number of vertices or faces\"); // wrong number of lines\n    }\n\n    if (vertices.some(vertex => vertex.length !== 3)) {\n        parseError(\"wrong number of coordinates in a vertex\");\n    }\n\n    if (faces.some(face => face[0] !== face.length - 1)) {\n        parseError(\"wrong number of vertices in a face\");\n    }\n\n    faces = faces.map(face => face.slice(1)); // remove number of vertices\n\n    return [vertices, faces];\n}\n\nfunction parseError(msg) {\n    console.log(`parse error: ${msg}`);\n    throw \"parse error; see console for details\";\n}\n","\"use strict\";\n\nimport { vec3, normalize } from \"./MV+.js\";\nimport { Extent } from \"./Extent.js\";\n\n/**\n * Represents a mesh of separable faces.\n *\n * Stores the mesh as a list of vertices, a list of normals for the vertices,\n * and a list of (size, offset) pairs representing the faces by their positions\n * in the other two lists.\n *\n * The constructor takes in a list of vertices and an index array of faces.\n */\nexport class Mesh {\n    constructor(vertices, faces) {\n        this.extent = Extent.fromVecs(vertices);\n\n        // Copy vertices so each face has its own copies\n        this._allvertices = Object.freeze(\n            faces.flatMap(\n                face => face.map(\n                    v => vertices[v])));\n\n        let faceoffsets = [];\n        let offset = 0;\n\n        // Create list of (size, offset) pairs per face\n        for (let size of faces.map(face => face.length)) {\n            faceoffsets.push(Object.freeze([size, offset]));\n            offset += size;\n        }\n\n        this._faces = Object.freeze(faceoffsets);\n\n        this._normals = [];\n\n        for (let face of faces) {\n            let face2 = face.slice(1).concat(face[0]);\n            let vertexpairs = face.map((_, i) => [vertices[face[i]],\n                                                  vertices[face2[i]]]);\n            let x = 0,\n                y = 0,\n                z = 0;\n\n            for (let [[x1, y1, z1], [x2, y2, z2]] of vertexpairs) {\n                x += (y1 - y2) * (z1 + z2);\n                y += (z1 - z2) * (x1 + x2);\n                z += (x1 - x2) * (y1 + y2);\n            }\n\n            for (let _ of face) {\n                this._normals.push(normalize(vec3(x, y, z)));\n            }\n        }\n    }\n\n    /**\n     * @returns {vec3[]} An array of the vertices in this mesh.\n     */\n    get vertices() {\n        return this._allvertices;\n    }\n\n    /**\n     * @returns {[number, number][]} the (size, offset) pairs for each face\n     */\n    get faceoffsets() {\n        return this._faces;\n    }\n\n    /**\n     * @returns {vec3[]} an array of normals for the vertices\n     */\n    get normals() {\n        return this._normals;\n    }\n}\n","/* WebGL initialization functions. */\n\n/**\n * Display the {@code #errorMessage} element with the given message\n */\nfunction showError(message) {\n    let errelt = document.querySelector(\"#errorMessage\");\n    errelt.innerHTML = message;\n    errelt.style.display = \"block\";\n}\n\n/**\n * Create and compile a shader of the given type\n * @param {WebGLRenderingContext} gl\n * @param shaderType\n * @param {String} programText\n * @returns {?WebGLShader}\n */\nfunction makeShader(gl, shaderType, programText) {\n    let shader = gl.createShader(shaderType);\n    gl.shaderSource(shader, programText);\n    gl.compileShader(shader);\n    if (gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        return shader;\n    }\n    else {\n        console.error(\"Failed to create shader: \" + gl.getShaderInfoLog(shader));\n        showError(shaderCreationError(shaderType === gl.VERTEX_SHADER ? \"vertex\" : \"fragment\"));\n        return null;\n    }\n}\n\n/**\n * Combine shaders into a program\n * @param {WebGLRenderingContext} gl\n * @param {WebGLShader} vertexShader\n * @param {WebGLShader} fragmentShader\n * @returns {?WebGLProgram}\n */\nfunction linkShaders(gl, vertexShader, fragmentShader) {\n    let program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n    if (gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        return program;\n    } else {\n        console.error(\"Failed to link shaders.\" + gl.getProgramInfoLog(program));\n        showError(shaderLinkError);\n        return null;\n    }\n}\n\n/**\n * Create and prepare a WebGL context.\n * @param {HTMLCanvasElement} canvas The canvas on which to draw.\n * @returns {?WebGLRenderingContext} The WebGL context..\n *\n * If the WebGL context is created and the required extensions loaded, it will be\n * returned, otherwise,  will be {@code null}.\n */\nexport function setupWebGL(canvas) {\n    let gl = canvas.getContext(\"webgl\");\n\n    if (!gl) {\n        showError(webGlSetupError);\n        return null;\n    }\n\n    return gl;\n}\n\n/**\n * Activate the vertex array object extension\n */\nexport function enableVAO(gl) {\n    let vao = gl.getExtension(\"OES_vertex_array_object\");\n\n    if (vao === null) {\n        showError(VAOError);\n        return null;\n    }\n\n    return vao;\n}\n\n/**\n * Prepare a program from the given WebGL context and shader programs.\n * @param {WebGLRenderingContext} gl The WebGL context.\n * @param {DOMString} vertexShaderProgram The text of the vertex shader program.\n * @param {DOMString} fragmentShaderProgram The text of the fragment shader program.\n * @returns {?WebGLProgram} The program.\n *\n * If the shaders fail to compile or link, the returned program will be {@code null}.\n */\nexport function setupProgram(gl, vertexShaderProgram, fragmentShaderProgram) {\n    // Set up shaders and program.\n\n    let vertexShader = makeShader(gl, gl.VERTEX_SHADER, vertexShaderProgram);\n    if (vertexShader === null) {\n        return null;\n    }\n    let fragmentShader = makeShader(gl, gl.FRAGMENT_SHADER, fragmentShaderProgram);\n    if (fragmentShader === null) {\n        return null;\n    }\n    let program = linkShaders(gl, vertexShader, fragmentShader);\n    if (program === null) {\n        return null;\n    }\n\n    return program;\n}\n\n//// Error messages\n\nlet webGlSetupError = `\n     <p>Error: unable to create WebGL context.</p>\n     <p>Make sure you are using a browser that supports <a href=\"https://get.webgl.\">WebGL</a>.</p>\n`;\n\nlet VAOError = `\n    <p>\n        Error: unable to load\n    <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/OES_vertex_array_object\">\n        <code>OES_vertex_array_object</code>\n        </a> extension.\n    </p>\n    <p>Please use a browser that supports this extension, such as\n        <a href=\"https://www.google.com/chrome/\">Google Chrome</a> or\n        <a href=\"https://www.mozilla.org/en-US/firefox/n~ew/\">Firefox</a>.\n    </p>\n`;\n\n/**\n * Create an error message for either shadr\n * @param {string} shader Either \"vertex\" or \"fragment\"\n */\nfunction shaderCreationError(shader) {\n    return `<p>Failed to create ${shader} shader. View the console for more information.</p>`;\n}\n\nlet shaderLinkError = \"<p>Failed to link shaders. View the console for more information.</p>\";\n","/**\n * Get a keyboard key in the user interface by key name, as given by\n * {@link KeyboardEvent.key}, case-insensitive.\n */\nfunction uiKey(key) {\n    if (typeof key === \"string\") {\n        return document.querySelector(`kbd.key.${key.toLowerCase()}`);\n    }\n    else {\n        return key;\n    }\n}\n\n/**\n * Add the activation hightlight to one key and optionally remove it from another\n * @param {String} key The key to highlight\n * @param {?String} offKey A key to un-highlight\n *\n * @see activateKey\n * @see deactivateKey\n */\nexport function activate(key, offKey = null) {\n    key = uiKey(key);\n    if (key) {\n        key.classList.add(\"active\");\n    }\n\n    if (offKey) {\n        deactivate(offKey);\n    }\n}\n\n/**\n * Toggle the activation highlight for a keyboard control in the UI\n *\n * @param {String} key The key to toggle\n * @param {?String} offKey A key to deactivate if the toggled key is turned on\n * @param {?boolean} disableShared whether to disabled shared keys\n *\n * If the key has the {@code shared} CSS class and {@code disableShared} is\n * true, deactivate all other keys with that class.\n */\nexport function toggle(key, offKey = null, disableShared = true) {\n    key = uiKey(key);\n    if (key) {\n        let active = key.classList.toggle(\"active\");\n        if (disableShared && key.classList.contains(\"shared\")) {\n            deactivateSelector(\".shared\");\n        }\n        if (active) {\n            activate(key);\n            if (offKey) {\n                deactivate(offKey);\n            }\n        }\n    }\n}\n\n/**\n * Remove the activation highlight from a keyboard control in the UI\n */\nexport function deactivate(key) {\n    key = uiKey(key);\n    if (key) {\n        key.classList.remove(\"active\");\n    }\n}\n\n/**\n * Remove highlighting from all keys in the user interface\n */\nexport function deactivateAll() {\n    deactivateSelector(\"*\");\n}\n\n/**\n * Remove highlighting form all keys with the given class\n */\nexport function deactivateClass(classname) {\n    deactivateSelector(`.${classname}`);\n}\n\n/**\n * Remove highlighting from keys matching a DOM selector\n *\n * Appends {@code .key} to the selector.\n */\nexport function deactivateSelector(selector) {\n    document.querySelectorAll(`${selector}.key`).forEach(k => k.classList.remove(\"active\"));\n}\n","/* Extra features:\n *\n * - Pressing F stops all active animations\n * - Pressing Q stops all animations and resets the mesh to its initial position.\n *\n * - Adjustable animation speeds. All of the animations have adjustable speed,\n *   which can be updated without restarting and without causing the animations\n *   to skip.\n * - Adjustable \"explosion\" magnitude (this will cause the explosion to skip,\n *   because it effects the size of the explosion immediately).\n *\n * - When the checkbox is checked, the mesh may be translated in multiple\n *   directions at the same time.\n *\n * - Anti-lag: animations are based on time passed and position, not frames, so\n *   a delay between frames will not prevent the animation from progressing\n *   normally.\n *\n * - Visual UI: when an animation is active, the corresponding key in the list\n *   of controls is highlighted. The Q and F controls instead highlight when\n *   those keys are pressed.\n */\n\n\"use strict\";\n\nimport { AnimationState } from \"./Animations.js\";\nimport { Extent } from \"./Extent.js\";\nimport { readFile, parsePly } from \"./filereaders.js\";\nimport { Mesh } from \"./Mesh.js\";\nimport { vec2, vec3, vec4 } from \"./MV+.js\";\nimport { setupWebGL, setupProgram, enableVAO } from \"./webgl-setup.js\";\n\nimport * as Key from \"./KeyboardUI.js\";\nimport * as MV from \"./MV+.js\";\n\n\n//// Constants\n\n// Initial settings. See the settings object.\nconst EXPLOSION_SCALE = 0.1,\n      EXPLOSION_SPEED = 0.01,\n      ROTATION_SPEED = 360/1000,\n      X_SPEED = 0.01,\n      Y_SPEED = 0.01,\n      Z_SPEED = 0.01,\n      MULTI_AXIS_MOVEMENT = false;\n\nconst X_FIELD_OF_VIEW = 90,\n      ASPECT_RATIO = 5/3;\n\nconst MIN_CANVAS_HEIGHT = 200;\n\nconst PERSPECTIVE_NEAR_PLANE = 0.001,\n      PERSPECTIVE_FAR_PLANE = 1000;\n\n\n//// Prepare the canvas\n\nconst canvas = document.querySelector(\"#webglCanvas\");\n\n{\n    // Set height to either 200 or as tall as it can be without pushing anything else off-screen\n    canvas.height = 0;\n    let body = window.getComputedStyle(document.body);\n    let height = document.body.scrollHeight + parseInt(body.marginTop) + parseInt(body.marginTop);\n\n    canvas.height = Math.max(MIN_CANVAS_HEIGHT, window.innerHeight - height);\n\n    // Set width to\n    canvas.width = (canvas.height * ASPECT_RATIO);\n    if (canvas.width > document.body.clientWidth) {\n        canvas.width = document.body.clientWidth;\n        canvas.height = canvas.width / ASPECT_RATIO;\n    }\n}\n\n\n//// Set up WebGL, the program, buffers, and shader variables\n\nconst gl = setupWebGL(canvas);\nif (gl === null) {\n    throw new Error(\"Failed to set up WebGL\");\n}\n\nconst program = setupProgram(gl,\n    document.querySelector(\"#vertexShader\").text,\n    document.querySelector(\"#fragmentShader\").text);\nif (program === null) {\n    throw new Error(\"Failed to set up program\");\n}\n\ngl.useProgram(program);\n\n\nconst buffers = Object.freeze({\n    position: gl.createBuffer(), // vertices\n    normal: gl.createBuffer(),   // normal vectors\n});\n\n// Set up the shader variables\nconst shader = Object.freeze({\n    position:         gl.getAttribLocation(program, \"aPosition\"),\n    faceNormal:       gl.getAttribLocation(program, \"faceNormal\"),\n\n    explosionScale:   gl.getUniformLocation(program, \"explosionScale\"),\n\n    modelMatrix:      gl.getUniformLocation(program, \"modelMatrix\"),\n    viewMatrix:       gl.getUniformLocation(program, \"viewMatrix\"),\n    projectionMatrix: gl.getUniformLocation(program, \"projectionMatrix\"),\n});\n\n\n\n//// Global animation state\n\n/**\n * Container for configural animation settings\n *\n * @property {number} explosion_scale   multiplier for explosion size\n * @property {number} explosion_speed   percent of explosion per millisecond\n * @property {number} rotation_speed    degrees of rotation per millisecond\n * @property {number} x_speed           multiplier for movement along X-axis\n * @property {number} y_speed           multiplier for movement along Y-axis\n * @property {number} z_speed           multiplier for movement along Z axis\n * @property {boolean} multi_axis_movement whether to allow movement along more\n *                                         than one axis at the same time\n */\nclass Settings {\n    constructor() {\n        this.initialize();\n        this.uiElements = [];\n        Object.seal(this); // prevent addition of new properties\n    }\n\n    initialize() {\n        this.explosion_scale = EXPLOSION_SCALE;\n        this.explosion_speed = EXPLOSION_SPEED;\n        this.rotation_speed = ROTATION_SPEED;\n        this.x_speed = X_SPEED;\n        this.y_speed = Y_SPEED;\n        this.z_speed = Z_SPEED;\n        this.multi_axis_movement = MULTI_AXIS_MOVEMENT;\n    }\n\n    reset() {\n        this.initialize();\n\n        for (let [setting, element] of this.uiElements) {\n            element.value = this[setting];\n        }\n    }\n\n    /**\n     * Register a UI element to reset when settings reset\n     *\n     * @param {String} setting The setting associated with the UI element\n     * @param {Element} element The element to associate with the setting\n     *\n     * When settings are reset, the element's {@code value} will be set to the\n     * setting's value.\n     */\n    bindUI(setting, element) {\n        this.uiElements.push([setting, element]);\n    }\n}\n\n/**\n * Global user-configurable settings object\n *\n * @see Settings\n */\nconst settings = new Settings();\n\n/**\n * Determine current explosion position as function of time\n *\n * This is applied after {@link settings.explosion_speed}\n */\nfunction easeExplosion(t) {\n    return (1 - Math.cos(t)) / 2;\n}\n\n/**\n * Global animation state\n *\n * @see AnimationState\n */\nconst animationState = new AnimationState(settings);\n\n\n\n//// Canvas/GL/Mesh preparation functions\n\nfunction clearCanvas() {\n    gl.clearColor(0, 0, 0, 1);\n    gl.clearDepth(1);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n}\n\nfunction distance(p1, p2) {\n    return Math.sqrt((p1[0] - p2[0]) ** 2 +\n                     (p1[1] - p2[1]) ** 2 +\n                     (p1[2] - p2[2]) ** 2);\n}\n\n/**\n * Set up the projection and view matrices based on the mesh\n *\n * The mesh is viewed from distance equal to its depth (z-width), with a 10%\n * margin in all directions.\n */\nfunction setProjection(mesh) {\n    let bounds = mesh.extent;\n\n    let fov_x = X_FIELD_OF_VIEW * Math.PI / 180,\n        fov_y = fov_x / ASPECT_RATIO,\n        // Distance required to view entire width/height\n        width_distance = bounds.width / (2 * Math.tan(fov_x / 2)),\n        height_distance = bounds.height / (2 * Math.tan(fov_y / 2)),\n        // Distance camera must be to view full mesh\n        camera_z = bounds.near + Math.max(width_distance, height_distance) * 1.1;\n\n    let projectionMatrix = MV.perspectiveRad(\n        fov_y, ASPECT_RATIO, PERSPECTIVE_NEAR_PLANE, PERSPECTIVE_FAR_PLANE);\n\n\tlet eye = vec3(bounds.midpoint[0],\n                   bounds.midpoint[1],\n                   camera_z),\n\t    at = bounds.midpoint,\n\t    up = vec3(0, 1, 0);\n\n\tvar viewMatrix = MV.lookAt(eye, at, up);\n\n    // Add margins around the mesh\n    var margins = MV.scalem(0.9, 0.9, 0.9);\n    projectionMatrix = MV.mult(margins, projectionMatrix);\n\n    gl.uniformMatrix4fv(shader.projectionMatrix,\n                        false,\n                        MV.flatten(projectionMatrix));\n\n    gl.uniformMatrix4fv(shader.viewMatrix,\n                        false,\n                        MV.flatten(viewMatrix));\n}\n\n/**\n * Set the normal vectors in the shader for the given mesh\n */\nfunction setNormals(mesh) {\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.normal);\n\n    gl.vertexAttribPointer(shader.faceNormal, 3, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(shader.faceNormal);\n\n    gl.bufferData(gl.ARRAY_BUFFER,\n                  MV.flatten(mesh.normals),\n                  gl.STATIC_DRAW);\n}\n\n/**\n * Set the vertices in the shader for the given mesh\n */\nfunction setVertices(mesh) {\n    gl.bindBuffer(gl.ARRAY_BUFFER, buffers.position);\n\n    gl.vertexAttribPointer(shader.position, 3, gl.FLOAT, false, 0, 0);\n    gl.enableVertexAttribArray(shader.position);\n\n    gl.bufferData(gl.ARRAY_BUFFER,\n                  MV.flatten(mesh.vertices),\n                  gl.STATIC_DRAW);\n}\n\n\n\n/**\n * Prepare webgl and the animations for a new mesh\n */\nfunction animateMesh(mesh) {\n    animationState.reset();\n    drawMesh(mesh);\n}\n\n/**\n * Draw and animate the shape specified by the arguments\n * @param {Mesh} mesh\n */\nfunction drawMesh(mesh) {\n    let bounds = mesh.extent;\n\n    let explosionSize = settings.explosion_scale * bounds.radius,\n        t_exp = animationState.explosion.position,\n        normalScale = easeExplosion(t_exp); // Distance of movement along face normals\n\n    gl.uniform1f(shader.explosionScale, normalScale * explosionSize);\n\n    let rotation = MV.rotateX(animationState.xrotation.position);\n\n    let tr_x = bounds.radius * animationState.xtranslation.position,\n        tr_y = bounds.radius * animationState.ytranslation.position,\n        tr_z = bounds.radius * animationState.ztranslation.position,\n        translation = MV.translate(tr_x, tr_y, tr_z);\n\n    let model = MV.mult(translation, rotation);\n\n    gl.uniformMatrix4fv(shader.modelMatrix, false, MV.flatten(model));\n\n    clearCanvas();\n\n    for (let [size, offset] of mesh.faceoffsets) {\n        gl.drawArrays(gl.LINE_LOOP, offset, size);\n    }\n\n    animationState.animate(() => drawMesh(mesh));\n}\n\n\n\n//// Control initialization\n\n\n// File upload controls / \"main\" function\ndocument.querySelector(\"#fileControls input[type='file']\")\n    .addEventListener(\"change\", e => {\n        // Hide the parse error message if it was present\n        document.querySelector(\"#fileControls .error-message\").innerText = \"\";\n\n        readFile(e)\n            .then(parsePly)\n            .catch(reason => {\n                // If parsing fails, display a message to the user.\n                console.error(reason);\n                document\n                    .querySelector(\"#fileControls .error-message\")\n                    .innerText = \"parse error; see console for details\";\n                throw reason;\n            })\n            .then(([vertices, faces]) => {\n                animationState.cancel(); // Stop the ongoing animation\n                // Prepare the mesh and mesh-based WebGL variables\n                let mesh = new Mesh(vertices, faces);\n                setProjection(mesh);\n                setNormals(mesh);\n                setVertices(mesh);\n\n                animateMesh(mesh); // start the animations\n            })\n            .catch(console.error);\n    });\n\n// Remove highlight from Q and F keys when they are released.x\nwindow.addEventListener(\"keyup\", e => {\n    switch (e.key.toUpperCase()) {\n    case \"Q\": // fallthrough\n    case \"F\":\n        Key.deactivate(e.key);\n        break;\n    }\n});\n\n/**\n * Actions taken when a translation key is pressed\n *\n * @param {KeyboardEvent} event The triggering keydown event\n * @param {'x'|'y'|'z'} axis The axis to rotate along, \"x\", \"y\", or \"z\".\n * @param {number} scale A multiplier for the speed; should be +1 or -1\n * @param {String} opposingKey The key that produces the opposite translation\n *\n * If {@link settings.multi_axis_movement} is false, stops all other translations.\n */\nfunction translationControl(event, axis, scale, opposingKey) {\n    axis = axis.toLowerCase();\n\n    let animation = animationState[`${axis}translation`];\n\n    if (animation === undefined) {\n        throw new Error(\"Program error: invalid axis given or missing animation or speed setting\");\n    }\n\n    let alreadyRunning = animation.isrunning();\n\n    if (!settings.multi_axis_movement) {\n        animationState.stopTranslations();\n    }\n\n    // assumes both scales are +/- 1, which is true in this program\n    if (!(alreadyRunning && animation.scale === scale)) {\n        // Start animation unless it was already running in the right diretion\n        animation.scale = scale;\n        animation.start();\n    }\n    else {\n        animation.stop();\n    }\n    Key.toggle(event.key, opposingKey, !settings.multi_axis_movement);\n    event.preventDefault();\n}\n\n/**\n * Actions taken when a toggle-able control key is pressed\n *\n * @param {KeyboardEvent} event The triggering keydown event\n * @param {String} animation The animation, a property of {@link AnimationState}\n */\nfunction toggleControl(event, animation) {\n    if (!animationState.hasOwnProperty(animation)) {\n        throw new Error(\"Program error: invalid animation property\");\n    }\n\n    animationState[animation].toggle();\n    Key.toggle(event.key);\n    event.preventDefault();\n}\n\n// Keyboard controls\nwindow.addEventListener(\"keydown\", e => {\n    if (e.ctrlKey || e.altKey || e.metaKey) {\n        return; // Ignore keys with non-shift modifiers\n    }\n\n    switch (e.key.toUpperCase()) {\n        // Reset keys\n    case \"Q\":\n        animationState.reset();\n        Key.deactivateAll();\n        Key.activate(\"Q\");\n        e.preventDefault();\n        break;\n    case \"F\":\n        animationState.stopAnimations();\n        Key.deactivateClass(\"toggle\");\n        Key.activate(\"F\");\n        e.preventDefault();\n        break;\n\n        // Toggle-able controls\n    case \"B\":\n        toggleControl(e, \"explosion\");\n        break;\n    case \"R\":\n        toggleControl(e, \"xrotation\");\n        break;\n\n        // Translation controls\n    case \"X\":\n        translationControl(e, \"x\", 1, \"C\");\n        break;\n    case \"C\":\n        translationControl(e, \"x\", -1, \"X\");\n        break;\n    case \"Y\":\n        translationControl(e, \"y\", 1, \"U\");\n        break;\n    case \"U\":\n        translationControl(e, \"y\", -1, \"Y\");\n        break;\n    case \"Z\":\n        translationControl(e, \"z\", 1, \"A\");\n        break;\n    case \"A\":\n        translationControl(e, \"z\", -1, \"Z\");\n        break;\n    }\n});\n\n\n//// Configuration control setup\n\n// Bind the multi-axis-movement checkbox\ndocument.querySelector(\"#multiAxisMovement\")\n    .addEventListener(\"change\", e => {\n        settings.multi_axis_movement = e.target.value;\n    });\nsettings.bindUI(\"multi_axis_movement\", document.querySelector(\"#multiAxisMovement\"));\n\n/**\n * Bind an event listener for a slider that sets a property of an object.\n *\n * Also binds the reset button to restore values to their original values (when\n * this function was called), and sets the slider's current value to that value.\n *\n * @param {String} selector A selector string for the slider\n * @param {Object} object   The object that should have a property set\n * @param {String} property The name of the property to set\n */\nfunction bindSlider(selector, object, property) {\n    let defaultvalue = object[property],\n        slider = document.querySelector(selector);\n\n    slider.value = defaultvalue;\n\n    settings.bindUI(property, slider);\n\n    document.querySelector(\"button.reset\") .addEventListener(\"click\", e => {\n        object[property] = defaultvalue;\n        slider.value = defaultvalue;\n    });\n\n    slider.addEventListener(\"input\", e => {\n        object[property] = e.target.value;\n    });\n}\n\nbindSlider(\".speed-slider.explosion\", settings, \"explosion_speed\");\nbindSlider(\".speed-slider.x.rotation\", settings, \"rotation_speed\");\nbindSlider(\".speed-slider.x.translation\", settings, \"x_speed\");\nbindSlider(\".speed-slider.y.translation\", settings, \"y_speed\");\nbindSlider(\".speed-slider.z.translation\", settings, \"z_speed\");\nbindSlider(\".scale-slider.explosion\", settings, \"explosion_scale\");\n\nclearCanvas();\n"]}